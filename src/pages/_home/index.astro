---
import { getEntry } from "astro:content";
import BaseLayout from "@layouts/base.astro";
import { MetaGenerator } from "@utils/metaGenerator";
import NewsTicker from "./_components/news-ticker.astro";
import Headline from "./_components/headline.astro";
import LatestNews from "./_components/latest-news.astro";
import Authors from "./_components/authors.astro";

const entry = await getEntry("pages", "home");

if (entry === undefined) {
  return Astro.redirect("/articles");
}

const [newsTicker, headlines, latestNews, topAuthors] = entry.data.blocks;

const metedata = await MetaGenerator(entry);
---

<BaseLayout {...metedata}>
  <NewsTicker {...newsTicker} />
  <Headline count={headlines.count} />
  <LatestNews
    name={latestNews.name}
    link_path={latestNews.link.path}
    link_text={latestNews.link.label}
    count={latestNews.count}
  />
  <Authors
    name={topAuthors.name}
    link_path={topAuthors.link.path}
    link_text={topAuthors.link.label}
    count={topAuthors.count}
  />
</BaseLayout>
